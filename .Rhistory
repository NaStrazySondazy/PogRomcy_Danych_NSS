geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
scale_fill_manual(values=c("red"))
ggplot(permutacje.rozklad,aes(x=per.roz.kolejnosc))+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
scale_fill_manual(values=c("red", "blue"))
ggplot(permutacje.rozklad,aes(x=per.roz.kolejnosc, colour=absencja))+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad,aes(x=per.roz.kolejnosc, colour=absencja))+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
scale_fill_manual(values=c("red", "blue"))
ggplot(permutacje.rozklad,aes(x=per.roz.kolejnosc, colour=absencja))+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
permutacje.rozklad
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc, colour=per.roz.kolejnosc))+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc, fill=per.roz.kolejnosc))+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc), colour=per.roz.kolejnosc)+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc), colour=per.roz.kolejnosc)+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
scale_fill_manual(values=c("red", "blue"))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc), fill=per.roz.kolejnosc)+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
scale_fill_manual(values=c("red", "blue"))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc), fill=fill=as.factor(per.roz.kolejnosc))+geom_bar(binwidth=1)+
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc), fill=as.factor(per.roz.kolejnosc))+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
scale_fill_manual(values=c("red", "blue"))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc), fill=as.factor(per.roz.kolejnosc))+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
scale_fill_manual(values=c("red", "blue"))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc), fill=as.factor(per.roz.kolejnosc))+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc), fill=as.factor(absencja))+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc))+geom_bar(binwidth=1)+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc))+geom_bar(binwidth=1)+
scale_fill_manual(values=c("red", "blue", "green"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc))+geom_bar(binwidth=1)+
scale_fill_manual(breaks=c("0","1"), values=c("black","red"), guide="none")+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc))+geom_bar(binwidth=2)+
scale_fill_manual(breaks=c("0","1"), values=c("black","red"), guide="none")+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc))+geom_bar()+
scale_fill_manual(breaks=c("0","1"), values=c("black","red"), guide="none")+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc))+
geom_bar(permutacje.rozklad, aes(x=per.roz.kolejnosc), fill="red")+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc))+
geom_bar(permutacje.rozklad, aes(x=per.roz.kolejnosc), fill=factor(per.roz.kolejnosc))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc))+
geom_bar( data = permutacje.rozklad, aes(x=per.roz.kolejnosc), fill=factor(per.roz.kolejnosc))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(x=per.roz.kolejnosc))+
geom_bar( data = permutacje.rozklad, aes(x=per.roz.kolejnosc))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
mtcars
c <- ggplot(mtcars, aes(factor(cyl)))
c + geom_bar()
c + geom_bar() + coord_flip()
c + geom_bar(fill="white", colour="darkgreen")
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill="white", colour="darkgreen")+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill="white")+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill="grey50")+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("grey50","grey10", "grey90"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red","blue", "green"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red3","blue3", "green3"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red3","blue3", "green3"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=3)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red3","blue3", "green3"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=30)+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red3","blue3", "green3"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=10, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red3","blue3", "green3"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red3","deepskyblue", "green3"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red2","deepskyblue", "green2"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red2","deepskyblue", "green4"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red2","deepskyblue", "olivedrab3"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red2","deepskyblue", "olivedrab4"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red2","deepskyblue", "yellowgreen"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red2","deepskyblue", "olivedrab"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red2","deepskyblue", "yellowgreen"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
rm(c)
m
sample(m$Glosowanie, 10)
sample(m$Glosowanie, 10)==-1
sample(m$Glosowanie, 2)==-1
sum(sample(m$Glosowanie, 2)==-1)
sum(sample(m$Glosowanie, 2)==-1)
sum(sample(m$Glosowanie, 2)==-1)
sum(sample(m$Glosowanie, 2)==-1)/2
sum(sample(m$Glosowanie, 2)==-1)/2
sum(sample(m$Glosowanie, 2)==-1)/2
sum(sample(m$Glosowanie, 2)==-1)/2*100
sum(sample(m$Glosowanie, 2)==-1)/2*100
sum(sample(m$Glosowanie, 2)==-1)/2*100
paste(sum(sample(m$Glosowanie, 2)==-1)/2*100, "%", sep="")
p2<-c();
for (i in 1:1000){
p2<-paste(sum(sample(m$Glosowanie, 2)==-1)/2*100, "%", sep="")
}
table(p2)
p2<-c();
for (i in 1:1000){
p2[i]<-paste(sum(sample(m$Glosowanie, 2)==-1)/2*100, "%", sep="")
}
table(p2)
1:length(p2)
p2 data.frame( Lp=c(1:length(p2)), p2);
p2<-data.frame( Lp=c(1:length(p2)), p2);
p2<-c();
for (i in 1:1000){
p2[i]<-paste(sum(sample(m$Glosowanie, 2)==-1)/2*100, "%", sep="")
}
p2<-data.frame( Lp=c(1:length(p2)), absencja=p2);
p2 <- transform(p2, # przygotowanie danych
p2.kolejnosc=factor(
absencja, levels=c("0%", "50%", "100%"), order=TRUE));
p2.Tab <- as.data.frame(table(p2$absencja));
p2<-c();
for (i in 1:1000){
p2[i]<-paste(sum(sample(m$Glosowanie, 2)==-1)/2*100, "%", sep="")
}
p2<-data.frame( Lp=c(1:length(p2)), absencja=p2);
p2 <- transform(p2, # przygotowanie danych
p2.kolejnosc=factor(
absencja, levels=c("0%", "50%", "100%"), order=TRUE));
p2.Tab <- as.data.frame(table(p2$absencja));
ggplot(p2, aes(p2.kolejnosc))+
geom_bar( fill=c("red2","deepskyblue", "yellowgreen"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=p2.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15));
ggplot(p2, aes(p2.kolejnosc))+
geom_bar( fill=c("firebrick1","deepskyblue", "yellowgreen"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=p2.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15));
ggplot(p2, aes(p2.kolejnosc))+
geom_bar( fill=c("firebrick1","ightskyblue", "yellowgreen"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=p2.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15));
ggplot(p2, aes(p2.kolejnosc))+
geom_bar( fill=c("firebrick1","lightskyblue", "yellowgreen"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=p2.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15));
ggplot(p2, aes(p2.kolejnosc))+
geom_bar( fill=c("firebrick1","lightskyblue", "greenyellow"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=p2.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15));
ggplot(p2, aes(p2.kolejnosc))+
geom_bar( fill=c("firebrick1","lightskyblue", "darkolivegreen1"))+
ylab("Procent")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=p2.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15));
p2.Tab
ggplot(p2, aes(p2.kolejnosc))+
geom_bar( fill=c("firebrick1","lightskyblue", "darkolivegreen1"))+
ylab("Liczba prób")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=p2.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15));
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red2","deepskyblue", "yellowgreen"))+
ylab("Liczba prób")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15));
ggplot(permutacje.rozklad, aes(per.roz.kolejnosc))+
geom_bar( fill=c("red2","deepskyblue", "yellowgreen"), colour="black")+
ylab("Liczba prób")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=permutacje.rozklad.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15));
ggplot(p2, aes(p2.kolejnosc))+
geom_bar( fill=c("firebrick1","lightskyblue", "darkolivegreen1"))+
ylab("Liczba prób")+
xlab("Poziom absencji wyborczej w próbie")+
geom_text(data=p2.Tab,aes(x=Var1,y=Freq,label=Freq),vjust=5, size=5, face="bold")+
theme(axis.text.x = element_text(face="bold", color = "black", size=15));
get.wd()
getwd()
p2.Tab
p2.Tab$Freq[p2.Tab$Var1=="0%"]
source.with.encoding('~/.active-rstudio-document', encoding='UTF-8', echo=TRUE)
p6.2
source.with.encoding('~/.active-rstudio-document', encoding='UTF-8', echo=TRUE)
p6.2
ggplot(p6.2, aes(x = factor(p6.2), y = Freq)) +
geom_bar(stat="identity", fill="white", colour="black")+
scale_x_discrete(labels=c("0","1/6","2/6","3/6", "4/6", "5/6", "1"))
ggplot(p6.2, aes(x = factor(p6.2), y = Freq)) +
geom_bar(stat="identity", fill="white", colour="black")+
scale_x_discrete(labels=c("0","1/6","2/6","3/6", "4/6", "5/6", "1"))+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))
ggplot(p6.2, aes(x = factor(p6.2), y = Freq)) +
geom_bar(stat="identity", fill="white", colour="black", fill="grey50")+
scale_x_discrete(labels=c("0","1/6","2/6","3/6", "4/6", "5/6", "1"))+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
xlab("Poparcie w próbie")+
ylab("Liczba prób")
ggplot(p6.2, aes(x = factor(p6.2), y = Freq)) +
geom_bar(stat="identity", fill="grey50", colour="black")+
scale_x_discrete(labels=c("0","1/6","2/6","3/6", "4/6", "5/6", "1"))+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
xlab("Poparcie w próbie")+
ylab("Liczba prób")
ggplot(p6.2, aes(x = factor(p6.2), y = Freq)) +
geom_bar(stat="identity", fill="grey50", colour="black")+
scale_x_discrete(labels=c("0","1/6","2/6","3/6", "4/6", "5/6", "1"))+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
xlab("Poparcie w próbie")+
ylab("Liczba prób")+
geom_text(data=p6.2, aes(x = factor(p6.2), y = Freq, label=Freq) ,vjust=5, size=5, face="bold")
ggplot(p6.2, aes(x = factor(p6.2), y = Freq)) +
geom_bar(stat="identity", fill="grey50", colour="black")+
scale_x_discrete(labels=c("0","1/6","2/6","3/6", "4/6", "5/6", "1"))+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
xlab("Poparcie w próbie")+
ylab("Liczba prób")+
geom_text(data=p6.2, aes(x = factor(p6.2), y = Freq, label=Freq) ,vjust=0, size=5, face="bold")
ggplot(p6.2, aes(x = factor(p6.2), y = Freq)) +
geom_bar(stat="identity", fill="grey50", colour="black")+
scale_x_discrete(labels=c("0","1/6","2/6","3/6", "4/6", "5/6", "1"))+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
xlab("Poparcie w próbie")+
ylab("Liczba prób")+
geom_text(data=p6.2, aes(x = factor(p6.2), y = Freq, label=Freq) ,vjust=0, size=2, face="bold")
ggplot(p6.2, aes(x = factor(p6.2), y = Freq)) +
geom_bar(stat="identity", fill="grey50", colour="black")+
scale_x_discrete(labels=c("0","1/6","2/6","3/6", "4/6", "5/6", "1"))+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
xlab("Poparcie w próbie")+
ylab("Liczba prób")+
geom_text(data=p6.2, aes(x = factor(p6.2), y = Freq, label=Freq) ,vjust=0, size=3, face="bold")
ggplot(p6.2, aes(x = factor(p6.2), y = Freq)) +
geom_bar(stat="identity", fill="grey50", colour="black")+
scale_x_discrete(labels=c("0","1/6","2/6","3/6", "4/6", "5/6", "1"))+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
xlab("Poparcie w próbie")+
ylab("Liczba prób")+
geom_text(data=p6.2, aes(x = factor(p6.2), y = Freq, label=Freq) ,vjust=0, size=4, face="bold")
ggplot(p6.2, aes(x = factor(p6.2), y = Freq)) +
geom_bar(stat="identity", fill="lightskyblue", colour="black")+
scale_x_discrete(labels=c("0","1/6","2/6","3/6", "4/6", "5/6", "1"))+
theme(axis.text.x = element_text(face="bold", color = "black", size=15))+
xlab("Poparcie w próbie")+
ylab("Liczba prób")+
geom_text(data=p6.2, aes(x = factor(p6.2), y = Freq, label=Freq) ,vjust=0, size=4, face="bold")
ggplot(p6.2, aes(x = factor(p6.2), y = Freq))
source.with.encoding('~/.active-rstudio-document', encoding='UTF-8', echo=TRUE)
######################################### ANIMACJA
oopt = ani.options(interval = 0.2, nmax = 10) # ANIMACJA
## use a loop to create images one by one
# 0:ani.options("nmax")/10
for (i in 2:19) {
proba<-c()
for (j in 1:1000){
proba[j]<-round(sum(sample(x = m$Glosowanie, size = i, replace =F ) ==1)/i, 3)
}
hist(proba, xlim= c(0,1))
abline(v=7/20, col="red")
}
ani.options(oopt)
library(animation);
library(ggplot2);
options(OutDec= ",");
library(knitr);
library(XML);
library(RCurl)
# Przygotowanie funkcji czytającej dane
cleanGoogleTable <- function(dat, table=1, skip=0, ncols=NA, nrows=-1, header=TRUE, dropFirstCol=NA){
if(!is.data.frame(dat)){
dat <- dat[[table]]
}
if(is.na(dropFirstCol)) {
firstCol <- na.omit(dat[[1]])
if(all(firstCol == ".") || all(firstCol== as.character(seq_along(firstCol)))) {
dat <- dat[, -1]
}
} else if(dropFirstCol) {
dat <- dat[, -1]
}
if(skip > 0){
dat <- dat[-seq_len(skip), ]
}
if(nrow(dat) == 1) return(dat)
if(nrow(dat) >= 2){
if(all(is.na(dat[2, ]))) dat <- dat[-2, ]
}
if(header && nrow(dat) > 1){
header <- as.character(dat[1, ])
names(dat) <- header
dat <- dat[-1, ]
}
# Keep only desired columns
if(!is.na(ncols)){
ncols <- min(ncols, ncol(dat))
dat <- dat[, seq_len(ncols)]
}
# Keep only desired rows
if(nrows > 0){
nrows <- min(nrows, nrow(dat))
dat <- dat[seq_len(nrows), ]
}
# Rename rows
rownames(dat) <- seq_len(nrow(dat))
dat
}
# Przygotowanie funkcji czytającej dane
readGoogleSheet <- function(url, na.string="", header=TRUE){
stopifnot(require(XML))
# Suppress warnings because Google docs seems to have incomplete final line
suppressWarnings({
# doc <- paste(readLines(url), collapse=" ")
doc <- getURL(url, ssl.verifypeer=0L, followlocation=1L) # moje wlasne usprawnienie :D
})
if(nchar(doc) == 0) stop("No content found")
htmlTable <- gsub("^.*?(<table.*</table).*$", "\\1>", doc)
ret <- readHTMLTable(htmlTable, header=header, stringsAsFactors=FALSE, as.data.frame=TRUE, encoding="UTF-8")
lapply(ret, function(x){ x[ x == na.string] <- NA; x})
}
# Wgrywanie  danych z google dysku
gdoc <- "https://docs.google.com/spreadsheets/d/1iSt2ZD9F8DhEh8UonnYqZ71wG7gqm5MSlpiZM2vL-Gw/pubhtml?gid=1189066294&single=true"
elem <- readGoogleSheet(gdoc)
m <- cleanGoogleTable(elem, table=1)
m<-m[,colnames(m)!="X"]
######################################### ANIMACJA
oopt = ani.options(interval = 0.2, nmax = 10) # ANIMACJA
## use a loop to create images one by one
# 0:ani.options("nmax")/10
for (i in 2:19) {
proba<-c()
for (j in 1:1000){
proba[j]<-round(sum(sample(x = m$Glosowanie, size = i, replace =F ) ==1)/i, 3)
}
hist(proba, xlim= c(0,1))
abline(v=7/20, col="red")
}
ani.options(oopt)
getwd()
data.frame(table(1:10))
library(knitr)
